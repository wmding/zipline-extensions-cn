# 前言

本文主要来自<<高能物理数据分析--统计方法指南>>[<sup>1</sup>](#refer-anchor-1)

概率作用的体现有两种形式:

- 预测:  $\mu$ 子会有多大概率在漂移室产生信号.
- 统计推断: 推断漂移室产生的信号是否来自 $\mu$ 子.

# 概率密度函数

特征量:

- 期望

- 矩
  
  对概率分布$f(x)$, 对变量$x$的整数幂求期望, 称为(代数)矩.
  $$
  a_n = E(x^n)
  $$
  中心矩
  $$
  m_n = E[(x-\mu)^n]
  $$
  
  
  - 方差: 二阶中心矩
  
  - 偏度和峰度
    $$
    \gamma_1 = \frac{m^3}{\sigma^3}, \\
    \gamma_2 = \frac{m^4}{\sigma^4} - 3
    $$
    偏度大于0, 分布的高端有更**长**尾巴, 否则相反. 高斯分布的峰度为0, 这也是数字3存在的原因, 峰度大于0, 分布与高斯分布相比有更**宽**的尾巴: t分布与柯西分布峰度为正值, 均匀分布峰度为负值. 
  
  - 协方差和关联系数
  
    协方差为两个随机变量的联合矩
    $$
    cov[x,y]=E(xy)-E(x)E(y)
    $$
    若$f(x,y)$是因子化的, $f(x,y)=f(x)\cdot f(y)$, x,y相互独立, 协方差等于0: 相互独立的必要条件.
  
    关联系数是协方差的无量纲表示.
    $$
    \rho=\frac{cov[x,y]}{\sigma_x\sigma_y}
    $$
    如果有两个以上的变量$x_1,x_2,\cdots,x_n$, 可以表示成矩阵形式:
    $$
    V_{ij} = cov[x_i, x_j], \\
    \rho_{ij} = \frac{V_{ij}}{\sigma_i\cdot\sigma_j}
    $$
    
  - 边沿分布和投影
  
    如果$pdf$有多个变量, 现在只关注一个变量的信息的方法: 消除冗余参数的影响.
  
    - 投影: $f(x)|_y$
    - 边沿分布: $f(x)=\int f(x,y)dy$
  
  - 众数/最可几值(mode), 中位数,分位数 
  
    利用分位数来表征分布的离散程度对于非高斯分布比较有用.
  
- 累积分布函数
  $$
  F(a) = \int_{-\infty}^a{f(x)dx} 或 F(a) = \sum{f(x_i)\Theta(a-x_i)}
  $$
  $\Theta$ 函数为阶跃函数, x大于0, 取0; x小于0, 取1.

- 特征函数

  $pdf$的傅里叶变换:
  $$
  \phi(u)=E(e^{iux})=\int{e^{iux}f(x)dx}
  $$
  

# 理论分布

$x$表示实数型随机变量, $r$表示整数型随机变量

- 高斯分布

  也叫正态分布
  $$
  f(x;\mu, \sigma)=\frac{1}{\sqrt{2\pi}\sigma}e^{-\frac{(x-\mu)^2}{2\sigma^2}}
  $$
  根据**中心极限定理**任意一分布与自身进行多次卷积计算, 所得到的分布为高斯分布.

  高斯分布的随机变量值在均值周围一个标准差的概率约为68%, $p$值为32%. 该值可以用**误差函数**求得.

- 泊松分布

  描述期望为$\nu$, 发生次数为$n$的概率分布. 它的标准差为 $\sqrt{\nu}$
  $$
  f(n;\nu)=\frac{\nu^n}{n!}e^{-\nu}
  $$
  物理实验中, 获取的大多数样本符合泊松分布.

- 二项分布
  $$
  f(r;N,p)=\binom{N}{r} p^r(1-p^{N-r})=\frac{N!}{(N-r)!r!}p^r(1-p)^{N-r}
  $$
  通常令$q=1-p$, 该分布均值为$Np$, 标准差为$\sqrt{Npq}$.

  如果二项分布的p很小, 则二项分布可以用均值为 $Np$的泊松分布近似; 

  若N很大而p不是很小, 可以用高斯分布近似.

  如果结果有$n$种, 本征概率为$\{p_1,p_2,\cdots,p_n\}$, 第$n$种结果出现$r_n$次的概率称为多项分布:
  $$
  f(r_1,r_2,\cdots,r_n;N,p_1,p_2,\cdots,p_n)=\frac{N!}{\prod{r_i!}}\prod{p_i^{r_i}}
  $$
  
- 其他分布
  - 均匀分布
  
    均值为中心值, 标准差为$a/\sqrt{12}$, a为宽度.
  
  - 柯西分布: Breit-Weigner分布/Lorentz分布
  
    质量为$M$, 宽度为$\Gamma$的共振态, 产生截面随能量$E$的变化关系为:
    $$
    f(E;M,\Gamma)=\frac{1}{2\pi}\frac{\Gamma}{(E-M)^2+(\Gamma/2)^2}
    $$
    更简洁的无量纲形式为:
    $$
    f(x)=\frac{1}{\pi}\frac{1}{1+x^2}
    $$
    该分布称为柯西分布/Breit-Wigner分布/洛伦兹分布, 该分布均值为$M$, 标准差不存在, 半高宽为$\Gamma$.
  
    高斯分布的半高宽为$2\sqrt{2ln2}\sigma\approx 2.25\sigma$.
  
    当$\Gamma$远大于$E$的测量误差时, 该分布可以用来拟合共振峰的形状, 也可以用来拟合近似高斯但是有长尾巴的分布.
  
  - 朗道分布
  
    用来描述带电粒子在近磁场时的能量损失概率分布. 其均值和方差均不存在.
  
  - 负二项分布
  
    描述失败$k-1$次情形下成功次数为$r$, 第$k$次失败的概率:
    $$
    f(r;k,p)=\frac{(k-1+r)!}{r!(k-1)!}q^kp^r
    $$
    
  - $t$ 分布
  
    常常用于根据小样本来估计呈正态分布且方差值未知的样本的均值; 如果方差已知, 应该用正态分布估计.
  
    从高斯分布抽取一个样本$\{x_1, x_2,\cdots,x_n\}$, 构造普尔量(pull distribution):
    $$
    t = \frac{x_i-\mu}{\sigma}
    $$
    该分布趋于$N(0,1)$分布, 可以用趋于程度描述实验中的误差是否正确. 通常高斯分布均值未知, 可以用样本均值计算**普尔量**, 这样计算的普尔分布的标准差比1略小, 差一个乘因子$\sqrt{(n-1)/n}$. 对于高斯分布:
  
    - $\mu$已知: 其标准差估计为$\hat{\sigma}=\sqrt{\overline{(x-\mu)^2}}$.
    - $\mu$未知: 用样本均值替代, 标准差估计量为$\hat{\sigma}=\sqrt{n/(n-1)\overline{(x-\bar{x})^2}}$, 出现乘数的原因是样本标准差公式$\hat{\sigma}=\frac{1}{n-1}\sum{(x-\bar{x})}=\frac{n}{n-1}\overline{x-\bar{x}}$. 
  
    对于第二种情况, 估计值在$n$比较小时, 并不是一个好的估计量. 根据该标准差构造的$t$统计量
    $$
    t=\frac{x-\mu}{\hat{\sigma}}
    $$
    服从自由度为$n-1$的$t$分布. 自由度为$n$的$t$分布$pdf$为:
    $$
    f(t;n)=\frac{\Gamma(\frac{n+1}{2})}{\sqrt{n\pi\Gamma(\frac{n}{2})}}\frac{1}{(1+\frac{t^2}{n})^{\frac{n+1}{2}}}
    $$
    该分布当$n$足够大时趋近高斯分布, $n$小时, **$\hat{\sigma}$低于真实的$\sigma$**,会产生造成产生比较大的$t$值, 因此会产生更宽的尾巴. $t$分布的方差为$n/(n-2)$.
  
  - $\chi^2$ 分布
  
    有$n$对测量值$\{(x_i, y_i)\}$, 以及描述函数$g(x)$, 现在需要检查函数关系与测量值保持一致. 可以构建平方偏差:
    $$
    \chi^2=\sum_{i=1}^{n}(\frac{y_i-g(x_i)}{\sigma_i})^2
    $$
    $\sigma_i$为第$i$次测量的高斯误差.(通常代表$y$的测量精度, 每次测量都一样, 可以提到公式外)
  
    自由度为$n$的$\chi^2$分布, 期望值等于$n$, 标准差为$\sqrt{2n}$.
    $$
    f(\chi^2;n)=\frac{2^{-\frac{n}{2}}}{\Gamma(n/2)}\chi^{n-2}e^{-\chi^2/2}
    $$
    当$n$充分大时, $\chi^2$分布收敛于高斯分布, 但收敛速度很慢.
  
    $\chi^2$分布通常用来检验带误差的测量值与模型预期值是否一致. 通常用累计$\chi^2$分布加以处理.对于一个给定的$\chi^2$值, 其对应的累计$\chi^2$分布值等于$1-p$, 这里$p$代表$\chi^2$大于等于某个值的概率.与$t$分布类似, 可以通过查表法得出$p$值对应的$\chi^2$值, 该值通常记为上侧$\alpha$分位数, $p(x>c)=\alpha$, 记为$c=\chi^2_n(\alpha)$.
  
    如果$\chi^2$大于$n$, 那么$p$值很小, 有理由怀疑模型的正确性或数据的准确性.
  
    如果模型含有自由参数$\theta$, 需要通过拟合确定. 那么可以用$\chi^2$函数检查拟合好坏.此时$n$等于数据点减去待拟合参数个数, 称为**自由度**.
  
  - 对数正态分布
  
    任意一变量,如果可以表示为大量随机变量的乘积, 且没有一个占主导地位, 则该变量符合对数正态分布.
  
  - Weibull分布

# 概率

- 数学定义

  **柯尓莫哥洛夫公理**

- 古典定义

  **古典概率**: 可以通过基本对称性推出的离散概率定义, 比如掷骰子

- 频率定义
  $$
  P(A)=\lim_{N\rightarrow\infty}\frac{N(A)}{N}
  $$
  该定义满足**柯尓莫哥洛夫公理**.

  与古典概率定义相比, 频率定义不是取决于事件$A$的本征性质, 而是取决于所有可能结果在总体的构成.

  没有指定总体,$P(A)$是不确定的.

- 贝叶斯定义

  主观概率, 也称贝叶斯概率.

  **贝叶斯定理**:
  $$
  P(A|B)=\frac{P(B|A)\cdot P(A)}{P(B)}
  $$
  **出租车涂色问题**:

  某城市出租车15%黄色,85%绿色. 现一出租车逃逸, 目击者称出租车为黄色, 确信概率为80%, 问肇事出租车为黄色的概率多大?

  设出租车为黄色的事件为$A$, $P(A)=15\%$ 目击者认为逃逸出租车为黄色的概率$a$, 值得注意的是该概率为**主观概率**, 为观测值, 有可能对也有可能错, 应该根据全概率公式表示, $P(a)=P(a|A)P(A)+P(a|\bar{A})P(\bar{A})$,  其中$P(a|A)=80\%$. 根据贝叶斯定理:
  $$
  P(A|a)=\frac{P(a|A)\cdot P(A)}{P(a|A)P(A)+P(a|\bar{A})P(\bar{A})}
  $$
  带入计算结果为$0.4$, 说明$60\%$的可能为绿色车.

  可以推广下, $A$为某种理论猜想, $a$为观测值, 理论正确的概率可以理解为主观概率. 则$P(A)$称为先验概率, $P(A|a)$称为后验概率, 这两种概率在频率概率定义下是没有意义的.
  
  **三门问题(Monty Hall Problem)**
  
  有三个门, 后面分别是羊,羊,汽车. 你先选择一个门, 然后主持人打开另外两个门中的是羊的一扇门, 最后问你是否更改选择. 更改选择对选中汽车的概率是多少?
  
  设$H$为最初选择的门后是汽车的事件, 可以理解为猜想(hypothesis), 其概率也就是**先验概率**, $P(H)=1/3$, $P(\bar{H})=2/3$. 
  
  设$E$为主持人打开是羊的门的事件, 理解为证据(Evidence), 这是一个主观概率, 隐藏的信息为无论你选择对错, 主持人总是会打开一扇有羊的门, $P(E|H)=P(E|\bar{H})=1$. 用全概率公式表示:
  $$
  P(E) = P(E|H)P(H) + P(E|\bar{H})P(\bar{H})
  $$
  带入贝叶斯公式, **后验概率**$P(H|E)=1/3$. 说明事件$E$不会改变你最初选择正确的概率. 但最后就剩两扇门, 如果改变选择选中汽车的概率为$2/3$, 所以换是划算的.
  
  现在更换一种情况: 假设主持人不知道哪扇门有羊, 在剩下的两扇门中随机选了一扇是羊, 这种情况下是否应该更换呢?
  
  此时事件$E$的概率发生变化, $P(E|H)=1$,$P(E|\bar{H})=1/2$, 带入贝叶斯公式得, $P(H|E)=1/2$. 这种情况下换与不换是没有区别的.
  
   
  
  

# 统计推断与测量

标准的概率计算是从理论出发导出数据, 给出在某种条件下, 特定的随机事件发生的概率多大.

统计推断则是与之相反, 从数据出发导出理论. 这种理论模型包含某个参数$\theta$, 预言了获得某个结果的概率. 

- 似然函数

  含参数情况下概率密度函数的乘积即为似然函数, 记为$L(x;\theta)$.

  **似然原理**认为: 如果有了观测结果, 那么似然函数包含了所有关于参数$\theta$的信息. 这种公理假说在贝叶斯统计推断下一般认为是正确的, 但是在频率统计推断下, 一般认为是错误的. 因为频率推断一般要求总体的完备性.

- 频率的统计推断

  以顶夸克质量$m_t=(173.2\pm0.9) \rm{GeV}$为例子, 0.9为一倍偏差. 在频率统计范式下应该表述为顶夸克质量有68%的可能在$172.3<m_t[\rm{GeV}]<174.1$区间, 或者说$172.3<m_t[\rm{GeV}]<174.1$有68%的置信水平.

- 贝叶斯统计推断
  
  贝叶斯推断的几个要点:
  
  1. $\pi(\theta)$为先验分布.
  
  2. 获得观测值$x$后, 根据贝叶斯公式得出后验分布: $f(\theta|x)=f(x|\theta)\pi(\theta)/f(x)$, 其中根据全概率公式得:$f(x)=\int f(x|\theta)\pi(\theta)d\theta$.
  
  3. $f(x)$积分后不含$\theta$, 因此$f(\theta|x)\propto f(x|\theta)\pi(\theta)$
  
  4. 如果$\pi(\theta)$为均匀分布, 则$f(\theta|x)\propto f(x|\theta)$, 比例常数通过归一化得到.
  
  对于高斯型的测量值, 似然函数等同于贝叶斯诠释下的后验概率(假设先验信度为均匀分布).
  
  - 先验分布使用
  
    **稳健测量**: 稳健的实验测量不依赖先验分布的选择.
  
  - Jeffreys 先验分布



# 参考文献

<div id="refer-anchor-1"></div>

-[1] [高能物理数据分析](http://blog.sciencenet.cn/blog-502977-1168973.html)

-[2] [monty-hall-problem](https://brilliant.org/wiki/monty-hall-problem/)